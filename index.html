<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="指尖记忆" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
<meta name="keywords" content="php程序员">
<meta property="og:type" content="website">
<meta property="og:title" content="指尖记忆">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;index.html">
<meta property="og:site_name" content="指尖记忆">
<meta property="og:description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>指尖记忆</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">指尖记忆</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/18/php%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/18/php%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0/" class="post-title-link" itemprop="url">php面试基础知识--时间函数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2019-11-18 16:27:08 / 修改时间：16:27:23" itemprop="dateCreated datePublished" datetime="2019-11-18T16:27:08+08:00">2019-11-18</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p><strong>date() : string</strong></p>
<p>格式化一个本地时间／日期</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  $timestamp = time();  <span class="comment">//时间戳</span></span><br><span class="line">  date(<span class="string">'Y-m-d H:i:s'</span>, $timestamp );  <span class="comment">//返回当前时间，yyyy-mm-dd H:i:s格式</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>time()  : int</strong></li>
</ul>
<p>返回当前的 Unix 时间戳,（格林威治时间 1970 年 1 月 1 日 00:00:00）到当前时间的秒数</p>
<ul>
<li><strong>strtotime() : int</strong></li>
</ul>
<p>将任何字符串的日期时间描述解析为 Unix 时间戳（string to time）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"now"</span>), <span class="string">"\n"</span>;  <span class="comment">//当前时间</span></span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"10 September 2000"</span>), <span class="string">"\n"</span>;  </span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"+1 day"</span>), <span class="string">"\n"</span>;  <span class="comment">//明天</span></span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"+1 week"</span>), <span class="string">"\n"</span>;  <span class="comment">//下星期</span></span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"+1 week 2 days 4 hours 2 seconds"</span>), <span class="string">"\n"</span>;</span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"next Thursday"</span>), <span class="string">"\n"</span>;  <span class="comment">//下周三</span></span><br><span class="line">  <span class="keyword">echo</span> strtotime(<span class="string">"last Monday"</span>), <span class="string">"\n"</span>;    <span class="comment">//上周一</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>microtime() : mixed</strong></li>
</ul>
<p>返回当前 Unix 时间戳和微秒数，PHP没有直接返回毫秒的函数，要想获取当前时间毫秒，这里用微秒格式化一下生产微秒。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">return</span> sprintf(<span class="string">'%.0f'</span>, microtime(<span class="keyword">true</span>) * <span class="number">1000</span>);  <span class="comment">//true，microtime() 将返回一个浮点数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>常见时间格式转换</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">//$time 时间戳</span></span><br><span class="line">  <span class="keyword">public</span> checkTime($time)</span><br><span class="line">  &#123;</span><br><span class="line">        $return_str = <span class="string">''</span>;</span><br><span class="line">        $diff = $time - time();</span><br><span class="line">        <span class="keyword">switch</span> ($diff) &#123;</span><br><span class="line">            <span class="keyword">case</span> $diff &lt; <span class="number">60</span>:</span><br><span class="line">                $return_str = $diff.<span class="string">'秒前'</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> $diff &gt;= <span class="number">60</span> &amp;&amp; $diff &lt; <span class="number">60</span> * <span class="number">60</span>:</span><br><span class="line">                $diff_i = round($diff/<span class="number">60</span>).<span class="string">'分'</span>;</span><br><span class="line">                $diff_s = ($diff - ($diff_i * <span class="number">60</span>)) &gt; <span class="number">0</span> ? ($diff - ($diff_i * <span class="number">60</span>)) .<span class="string">'秒'</span> : <span class="string">''</span>;</span><br><span class="line">                $return_str = $diff_i.$diff_s.<span class="string">'前'</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> $diff &gt;= <span class="number">60</span> * <span class="number">60</span> &amp;&amp; $diff &lt;= <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>:</span><br><span class="line">                $return_str = round($diff/(<span class="number">60</span> * <span class="number">60</span>)).<span class="string">'小时前'</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> $diff &lt;= <span class="number">30</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>:</span><br><span class="line">                $return_str = round($diff/(<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>)).<span class="string">'天前'</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                $return_str = date(<span class="string">'Y'</span>.<span class="string">'年'</span>.<span class="string">'m'</span>.<span class="string">'月'</span>.<span class="string">'d'</span>.<span class="string">'日'</span>, $time);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $return_str;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/10/%E4%BA%92%E8%81%94%E7%BD%91%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/10/%E4%BA%92%E8%81%94%E7%BD%91%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B%E8%A7%84%E8%8C%83/" class="post-title-link" itemprop="url">互联网项目开发流程规范</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-10 22:31:02" itemprop="dateCreated datePublished" datetime="2019-11-10T22:31:02+08:00">2019-11-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 14:17:15" itemprop="dateModified" datetime="2019-11-18T14:17:15+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>62</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<p>今天分享一下项目开发过程中规范流程的一张图，流程、文字说明都在图上。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7429691-9c7f5804051169ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="产品开发流程图.png"></p>
<p>如果跟你们公司开发过程中有不一样的地方，欢迎下发留言哈。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/git%E9%A1%B9%E7%9B%AE%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B%E8%A7%84%E8%8C%83%E6%A2%B3%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/08/git%E9%A1%B9%E7%9B%AE%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B%E8%A7%84%E8%8C%83%E6%A2%B3%E7%90%86/" class="post-title-link" itemprop="url">git项目版本控制流程规范梳理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-08 22:22:48" itemprop="dateCreated datePublished" datetime="2019-11-08T22:22:48+08:00">2019-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 13:59:02" itemprop="dateModified" datetime="2019-11-18T13:59:02+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>662</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><p><img src="https://upload-images.jianshu.io/upload_images/7429691-caa1a148645bc944.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="git版本控制"></p>
<h3 id="常见的分支"><a href="#常见的分支" class="headerlink" title="常见的分支"></a>常见的分支</h3><ul>
<li><strong>master：</strong>上线分支，每一个版本需要打上一个tag标签。每一个版本更新的内容可多可细，tag1.2.3，第一位数字1是系统更新的大版本，数字2是更新的大功能点，数字3是可以是优化、可以是修复、可以是小功能点。</li>
<li><strong>develop：</strong>开发分支，是当前项目的可进行测试的最新代码，每一次开发人员开发的新功能、bug、优化都需要合并同步更新到develop分支；此分支也是测试同学测试功能的分支。</li>
<li><strong>功能A（B/C）：</strong>功能分支，开发人员在develop拉出来进行具体功能点开发的分支。</li>
<li><strong>bug_fix：</strong>修复分支，线上版本出来紧急bug，拉出来的进行修复bug的分支。修复完后需要同步更新代码到develop分支。</li>
</ul>
<h3 id="环境介绍"><a href="#环境介绍" class="headerlink" title="环境介绍"></a>环境介绍</h3><p>一般一个项目部署的环境至少有本地环境、dev开发环境、fat环境、线上环境，只是最最基本的几个环境。</p>
<ul>
<li><strong>本地环境：</strong>不用介绍了吧这个，你的电脑虚拟机环境。【可以理解为<strong>本地的</strong>git版本】</li>
<li><strong>dev环境：</strong>开发自测、联调的环境【可以理解为开发对<strong>功能A（B/C）</strong>自测的环境】</li>
<li><strong>fat环境：</strong>测试用例测试和验证的环境【可以理解为<strong>develop分支</strong>部署，专门做上线前，测试验证、保证产品这里的测试环境】</li>
<li><strong>线上环境：</strong>给用户使用的正式环境【可以理解为<strong>master分支</strong>部署的环境】<br>当然，公司越大、项目越大、业务链路越复杂越长的用于开发、调试、使用的环境也就更多。可能会多一个<strong>sit环境（集成测试环境）、uat环境（预发布环境）</strong></li>
</ul>
<h3 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h3><p>我们就从新建一个项目开始和整个开发过程需要学习和熟练的版本控制内容。</p>
<hr>
<p>未完待续，或者您可以下方留言常见问题。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/07/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E4%BB%A3%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%89%E4%B8%9A%E5%8A%A1%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/07/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E4%BB%A3%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%89%E4%B8%9A%E5%8A%A1%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/" class="post-title-link" itemprop="url">第三方平台代小程序（公众号）业务常见错误</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-07 23:38:16" itemprop="dateCreated datePublished" datetime="2019-11-07T23:38:16+08:00">2019-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 14:20:00" itemprop="dateModified" datetime="2019-11-18T14:20:00+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />

<p><img src="https://upload-images.jianshu.io/upload_images/7429691-70d1c79d596ae7a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第三方平台接入"></p>
<ul>
<li><strong>component is not authorized by this account hint: [BZcV0a01294731]</strong></li>
</ul>
<p><strong>原因：</strong>公众号（小程序）未授权，<br><strong>解决：</strong>重新将其在授权给第三方应用就好了。</p>
<ul>
<li><strong>40001：invalid credential, access_token is invalid or not latest hint: [0947szc5!]</strong></li>
</ul>
<p><strong>原因：</strong>access_token无效或失效，<br><strong>解决：</strong>检查一下token是否正确；调用刷新token的接口，去拿到最新的token。</p>
<ul>
<li><strong>43001：require GET method hint: [yaNjnA01103955]</strong></li>
</ul>
<p><strong>原因：</strong>请求方式不出错，<br><strong>解决：</strong>查看文档接口请求方式，更换为post</p>
<ul>
<li><strong>61004：access clientip is not registered requestIP: 112.94.43.29 hint: [c7.QhA02174679!]</strong></li>
</ul>
<p><strong>原因：</strong>不在ip白名单内，<br><strong>解决：</strong>去第三方平台应用添加白名单IP地址列表</p>
<ul>
<li><strong>48001：api unauthorized hint: [qptaQa0711szb1!]</strong></li>
</ul>
<p><strong>原因：</strong>api功能未授权，<br><strong>解决：</strong>先确认是否有api权限，其次，查看你是不是把小程序的access_token拿去调用公众号的接口，或者反过来，或拿了第三方平台的token，反正就是你搞错了token。</p>
<ul>
<li><strong>47001：data format error hint: [2RnK01554870]</strong></li>
</ul>
<p><strong>原因：</strong>请求的数据格式有问题，可能是少了字段，可能是多了不必要的字段，可能是json字符串你传了json对象，</p>
<p><strong>解决：</strong>多看几遍微信的官方文档，检查自己的代码是否按照要求传参。</p>
<ul>
<li><strong>40066：invalid url hint: [l4ZooA0366z199!]</strong></li>
</ul>
<p><strong>原因：</strong>请求的url错了，可能是你从官网上复制的url就多了一个空格，可能你代码多了行回车，<br><strong>解决：</strong>检查自己的代码url是否正确。</p>
<ul>
<li><strong>89000：account has bound open hint: [aiYGTA0779sha1]</strong></li>
</ul>
<p><strong>原因：</strong>该公众号（小程序）已绑定了开发者账号，<br><strong>解决</strong>：登录公众号平台，查看绑定的开发者账号open_appid是多少，可以选择先调用解绑接口进行解绑，或直接在数据库插入旧的open_appid，不创建新的open_appid。</p>
<ul>
<li><strong>85001：user not exist or user cannot be searched hint: [Z4H.dA01174245]</strong></li>
</ul>
<p><strong>原因：</strong>添加小程序的体验者微信号不存在，或他关闭了被搜索到的功能，设置了权限，<br><strong>解决：</strong>输入对的微信号，或让他打开权限。</p>
<hr>
<p><strong>不要问我为什么知道这么多，全都是踩过的坑。如果您还遇到别的坑，请下方留言，来帮帮孩子</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/06/%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%89%E6%8E%88%E6%9D%83%E7%BB%99%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/06/%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%88%E5%85%AC%E4%BC%97%E5%8F%B7%EF%BC%89%E6%8E%88%E6%9D%83%E7%BB%99%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">小程序（公众号）授权给第三方平台流程梳理和实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-06 23:39:55" itemprop="dateCreated datePublished" datetime="2019-11-06T23:39:55+08:00">2019-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 14:17:29" itemprop="dateModified" datetime="2019-11-18T14:17:29+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />

<p><img src="https://upload-images.jianshu.io/upload_images/7429691-253978f27f3ebf96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h3><ul>
<li>在第三方平台应用上点击授权</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/7429691-1f822a5a2c7d5609.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>进入授权页面</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/7429691-44af97e1cc29aa64.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>弹出微信授权页面，下方会显示第三方应用的基本信息</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/7429691-0762d88b8864caeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li><strong>帐号管理员</strong>扫码，选择要授权的账号，进行授权（可自定义权限）</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/7429691-5fe7791c5d8e8a1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>是否授权成功，回调页面显示</li>
</ul>
<h3 id="技术实现"><a href="#技术实现" class="headerlink" title="技术实现"></a>技术实现</h3><h5 id="第三方平台方获取预授权码（pre-auth-code）"><a href="#第三方平台方获取预授权码（pre-auth-code）" class="headerlink" title="第三方平台方获取预授权码（pre_auth_code）"></a>第三方平台方获取预授权码（pre_auth_code）</h5><p>接入在第三方平台应用上点击授权的时候会获取授权的预授权码（pre_auth_code），有效期为10分钟。</p>
<ul>
<li>调用接口地址</li>
</ul>
<blockquote>
<p>POST <a href="https://api.weixin.qq.com/cgi-bin/component/api_create_preauthcode?component_access_token=COMPONENT_ACCESS_TOKEN" target="_blank" rel="noopener">https://api.weixin.qq.com/cgi-bin/component/api_create_preauthcode?component_access_token=COMPONENT_ACCESS_TOKEN</a></p>
</blockquote>
<p>在调用此接口前，需要先获取第三方平台的令牌（也叫接口调用凭证component_access_token）</p>
<ul>
<li>参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;component_appid&quot;: &quot;appid_value&quot; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="后端返回参数，前端拼装请求微信url"><a href="#后端返回参数，前端拼装请求微信url" class="headerlink" title="后端返回参数，前端拼装请求微信url"></a>后端返回参数，前端拼装请求微信url</h4><p>加入授权页面的时候，前端将后端返回的数据进行组织，点击组装后的url调整按钮，就可以弹出授权窗口。（<strong>微信做了限制，只能在第三方平台在设置的回调url地址才可以访问，其他本地地址无效</strong>）<br><img src="https://upload-images.jianshu.io/upload_images/7429691-f6cf588847e9aa89.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>后端返回的参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&apos;component_appid&apos; =&gt; &apos;XXX&apos;,  //第三方平台app_id</span><br><span class="line">&apos;pre_auth_code&apos;   =&gt; &apos;pre_auth_code&apos;  //  预授权码</span><br><span class="line">&apos;redirect_uri&apos;    =&gt; &apos;https://mp.weixin.qq.com/cgi-bin/componentloginpage&apos;,  //拼装的URL地址</span><br><span class="line">&apos;auth_type&apos;       =&gt;  1,  //1 2 3  要授权的帐号类型</span><br><span class="line">&apos;biz_appid&apos;       =&gt;  &apos;xxx&apos;  //指定授权唯一的小程序或公众号</span><br></pre></td></tr></table></figure>

<ul>
<li>拼装示例</li>
</ul>
<blockquote>
<p><a href="https://mp.weixin.qq.com/cgi-bin/componentloginpage?component_appid=xxxx&amp;pre_auth_code=xxxxx&amp;redirect_uri=xxxx&amp;auth_type=xxx" target="_blank" rel="noopener">https://mp.weixin.qq.com/cgi-bin/componentloginpage?component_appid=xxxx&amp;pre_auth_code=xxxxx&amp;redirect_uri=xxxx&amp;auth_type=xxx</a></p>
</blockquote>
<h4 id="用户授权，同意授权"><a href="#用户授权，同意授权" class="headerlink" title="用户授权，同意授权"></a>用户授权，同意授权</h4><p>用户进入第三方平台授权页后，需要确认并同意将自己的公众号或小程序授权给第三方平台方，完成授权流程。此时在微信上，公众号已经授权给第三方平台了，在公众号平台上可以看到授权平台。然后第三方平台需要拿到公众号的基本信息、授权信息和执行权限，需要回调地址进行处理、保存授权信息（<strong>access_token和refresh_token</strong>）。</p>
<h4 id="回调地址处理授权信息"><a href="#回调地址处理授权信息" class="headerlink" title="回调地址处理授权信息"></a>回调地址处理授权信息</h4><p>这个回调地址是在第三方平台上设置的，拿到授权码（auth_code）后，使用授权码换取公众号或小程序的接口调用凭据和授权信息。</p>
<ul>
<li>调用接口为：</li>
</ul>
<blockquote>
<p>POST <a href="https://api.weixin.qq.com/cgi-bin/component/api_query_auth?component_access_token=COMPONENT_ACCESS_TOKEN" target="_blank" rel="noopener">https://api.weixin.qq.com/cgi-bin/component/api_query_auth?component_access_token=COMPONENT_ACCESS_TOKEN</a></p>
</blockquote>
<ul>
<li>参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;component_appid&quot;:&quot;appid_value&quot; ,  //第三方平台 appid</span><br><span class="line">  &quot;authorization_code&quot;: &quot;auth_code_value&quot;  //授权码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回是仅仅是授权信息（authorization_info）。authorizer_appid，authorizer_access_token，expires_in，authorizer_refresh_token以及权限id集这些数据。稍未获得公众号一些基本帐号信息（公众号名称、头像等等），这时候需要去获取授权方的帐号基本信息。</p>
<ul>
<li>调用接口为：</li>
</ul>
<blockquote>
<p>POST <a href="https://api.weixin.qq.com/cgi-bin/component/api_get_authorizer_info?component_access_token==COMPONENT_ACCESS_TOKEN" target="_blank" rel="noopener">https://api.weixin.qq.com/cgi-bin/component/api_get_authorizer_info?component_access_token==COMPONENT_ACCESS_TOKEN</a></p>
</blockquote>
<ul>
<li>参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;component_appid&quot;:&quot;appid_value&quot; ,  //第三方平台 appid</span><br><span class="line">  &quot;authorizer_appid&quot;: &quot;auth_code_value&quot;  //授权方 appid</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拿到信息后你就可以保存到数据库里了，整个微信公众号授权的流程就结束了，后续根据各自业务对授权信息和帐号信息进行其他业务处理就ok。</p>
<h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><blockquote>
<p><strong>$this-&gt;request()-&gt;getParams()</strong> 是封装好的获取参数的方法，可自行替代<br><strong>getComAccessToken()</strong> 是封装好的获取第三方接口调用凭证的方法，可自行替代<br><strong>httpsCurl()</strong> 是封装好的请求微信的方法，可自行替代<br><strong>WX_APP_ID</strong> 是全局参数第三方平台的app_id</p>
</blockquote>
<p>PS:这里的代码仅仅只是把整个业务流程写在一起，方便阅读，实际场景中代码当然不会这样子写</p>
<p>获取预授权码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * Created by 沙蒿.</span><br><span class="line">     * @desc 获取预授权码pre_auth_code，有效期10分钟</span><br><span class="line">     */</span><br><span class="line">    public function getWxPreAuthCode()</span><br><span class="line">    &#123;</span><br><span class="line">        $authType = $this-&gt;request()-&gt;getParams(&apos;auth_type&apos;) ?? 1;</span><br><span class="line">        //1公众号授权，2小程序授权</span><br><span class="line">        if (empty($authType) || !in_array($authType, [1, 2])) &#123;</span><br><span class="line">            return $this-&gt;error(100201);</span><br><span class="line">        &#125;</span><br><span class="line">        //获取第三方平台接口调用凭证</span><br><span class="line">        $comAccToken = $this-&gt;getComAccessToken();</span><br><span class="line">        //请求微信服务器获取预授权码url地址</span><br><span class="line">        $url         = &apos;https://api.weixin.qq.com/cgi-bin/component/api_create_preauthcode?component_access_token=&apos; . $comAccToken;</span><br><span class="line">        // 获取授权请求二维码url地址</span><br><span class="line">        $reqUrl      = &apos;https://mp.weixin.qq.com/cgi-bin/componentloginpage&apos;;</span><br><span class="line">        $preAuthCode = CommonService::getInstance()-&gt;httpsCurl($url, &apos;post&apos;, &apos;json&apos;, [</span><br><span class="line">            &apos;component_appid&apos; =&gt; WX_APP_ID</span><br><span class="line">        ]);</span><br><span class="line">        //组装格式，返回</span><br><span class="line">        $result = [</span><br><span class="line">            &apos;component_appid&apos; =&gt; WX_APP_ID,</span><br><span class="line">            &apos;pre_auth_code&apos;   =&gt; $preAuthCode[&apos;pre_auth_code&apos;],</span><br><span class="line">            &apos;redirect_uri&apos;    =&gt; $reqUrl,</span><br><span class="line">            &apos;auth_type&apos;       =&gt; $authType,</span><br><span class="line">        ];</span><br><span class="line">        if (!empty($bizAppId)) &#123;</span><br><span class="line">            $result[&apos;biz_appid&apos;] = $bizAppId;</span><br><span class="line">        &#125;</span><br><span class="line">        return $result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>回调地址处理授权信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * Created by 沙蒿.</span><br><span class="line">     * @desc 微信授权</span><br><span class="line">     * 授权后回调URI，得到授权码（authorization_code）和过期时间10分钟,使用授权码换取公众号或小程序的接口调用凭据和授权信息</span><br><span class="line">     */</span><br><span class="line">    public function wxOAuth()</span><br><span class="line">    &#123;</span><br><span class="line">        //接收授权码auth_code</span><br><span class="line">        $code = $this-&gt;request()-&gt;getParams(&apos;auth_code&apos;);</span><br><span class="line">        //校验参数</span><br><span class="line">        if (empty($code)) &#123;</span><br><span class="line">            return $this-&gt;error(100202);</span><br><span class="line">        &#125;</span><br><span class="line">        //获取第三方平台的接口调用凭证</span><br><span class="line">        $comAccToken = $this-&gt;getComAccessToken();</span><br><span class="line">        //使用授权码换取公众号或小程序的接口调用凭据和授权信息</span><br><span class="line">        $queryAuthUrl = &apos;https://api.weixin.qq.com/cgi-bin/component/api_query_auth?component_access_token=&apos; . $comAccToken;</span><br><span class="line">        $authInfo     = CommonService::getInstance()-&gt;httpsCurl($queryAuthUrl, &apos;post&apos;, &apos;json&apos;, [</span><br><span class="line">            &apos;component_appid&apos;    =&gt; WX_APP_ID,</span><br><span class="line">            &apos;authorization_code&apos; =&gt; $code</span><br><span class="line">        ]);</span><br><span class="line">        //获取授权信息</span><br><span class="line">        $authInfo        = $authInfo[&apos;authorization_info&apos;];</span><br><span class="line">        $authorizerAppId = $authInfo[&apos;authorizer_appid&apos;]; //授权方appid</span><br><span class="line">        //获取授权方的帐号基本信息</span><br><span class="line">        $authorizerInfoUrl = &apos;https://api.weixin.qq.com/cgi-bin/component/api_get_authorizer_info?component_access_token=&apos; . $comAccToken;</span><br><span class="line">        $appInfo           = CommonService::getInstance()-&gt;httpsCurl($authorizerInfoUrl, &apos;post&apos;, &apos;json&apos;, [</span><br><span class="line">            &apos;component_appid&apos;  =&gt; WX_APP_ID,</span><br><span class="line">            &apos;authorizer_appid&apos; =&gt; $authorizerAppId</span><br><span class="line">        ]);</span><br><span class="line">        //保存授权信息和帐号信息</span><br><span class="line">        $this-&gt;saveWxAuth($authInfo, $appInfo);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/06/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E4%BB%A3%E6%9B%BF%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/06/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E4%BB%A3%E6%9B%BF%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD%E6%B5%81%E7%A8%8B%E6%A2%B3%E7%90%86%E5%92%8C%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">第三方平台代替小程序实现登录功能流程梳理和实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-06 23:39:16" itemprop="dateCreated datePublished" datetime="2019-11-06T23:39:16+08:00">2019-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 14:17:58" itemprop="dateModified" datetime="2019-11-18T14:17:58+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />

<p><img src="https://upload-images.jianshu.io/upload_images/7429691-70d1c79d596ae7a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="第三方平台接入"></p>
<h3 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h3><p><a href="[https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html)">微信官方文档</a><br><img src="https://upload-images.jianshu.io/upload_images/7429691-06c4cc6a442dc1f8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="微信小程序登录流程时序图"></p>
<h3 id="详细说明"><a href="#详细说明" class="headerlink" title="详细说明"></a>详细说明</h3><p>现在用户初次进入小程序中先需要用户进行授权操作，其实就是“登录”，然后拿到“用户信息”的操作。上面wx.login()只是拿到了登录code，并没有获取用户信息。一般小程序登录接口会给code和用户加密敏感信息相关字段。</p>
<ul>
<li>小程序调用的接口：<a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html" target="_blank" rel="noopener">登录</a> <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/user-info/wx.getUserInfo.html" target="_blank" rel="noopener">用户授权</a></li>
<li>后台登录参数</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>appId</td>
<td>string</td>
<td>小程序的app_id</td>
</tr>
<tr>
<td>code</td>
<td>string</td>
<td>登录code</td>
</tr>
<tr>
<td>rawData</td>
<td>string</td>
<td>不包括敏感信息的原始数据字符串，用于计算签名</td>
</tr>
<tr>
<td>signature</td>
<td>string</td>
<td>使用 sha1( rawData + sessionkey ) 得到字符串，用于校验用户信息，详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html" target="_blank" rel="noopener">用户数据的签名验证和加解密</a></td>
</tr>
<tr>
<td>encryptedData</td>
<td>string</td>
<td>包括敏感数据在内的完整用户信息的加密数据，详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html#%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">用户数据的签名验证和加解密</a></td>
</tr>
<tr>
<td>iv</td>
<td>string</td>
<td>加密算法的初始向量，详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html#%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">用户数据的签名验证和加解密</a></td>
</tr>
</tbody></table>
<hr>
<p>接收到参数后，从时序图可以知道。要拿code调用微信接口获取session_key和openid这些加密信息，然后对其进行解密，解密就用官方的<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html" target="_blank" rel="noopener">解密sdk</a>就好，最好保存小程序粉丝信息，返回自定义登录token给前端，下次前端请求接口的时候需要在请求头把自定义的tokne给过来验证。</p>
<ul>
<li><a href="https://developers.weixin.qq.com/doc/oplatform/Third-party_Platforms/Mini_Programs/WeChat_login.html" target="_blank" rel="noopener">小程序登录</a>调用地址</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://api.weixin.qq.com/sns/component/jscode2session?appid=APPID&amp;js_code=JSCODE&amp;grant_type=authorization_code&amp;component_appid=COMPONENT_APPID&amp;component_access_token=COMPONENT_ACCESS_TOKEN</span><br></pre></td></tr></table></figure>

<ul>
<li>参数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&apos;appid&apos;                  =&gt; appid,  //小程序appid</span><br><span class="line">&apos;js_code&apos;                =&gt; code,   //登录code</span><br><span class="line">&apos;grant_type&apos;             =&gt; &apos;authorization_code&apos;,  //固定值</span><br><span class="line">&apos;component_appid&apos;        =&gt; WX_APP_ID,   //第三方平台 appid</span><br><span class="line">&apos;component_access_token&apos; =&gt; $comAccToke  //第三方平台接口凭证</span><br></pre></td></tr></table></figure>

<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><blockquote>
<p><strong>$this-&gt;request()-&gt;getParams()</strong> 是封装好的获取参数的方法，可自行替代<br><strong>getComAccessToken()</strong> 是封装好的获取第三方接口调用凭证的方法，可自行替代<br><strong>httpsCurl()</strong> 是封装好的请求微信的方法，可自行替代<br><strong>WX_APP_ID</strong> 是全局参数第三方平台的app_id</p>
</blockquote>
<p>PS:这里的代码仅仅只是把整个业务流程写在一起，方便阅读，实际场景中代码当然不会这样子写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * Created by 沙蒿.</span><br><span class="line">     * @desc 小程序用户授权登录</span><br><span class="line">     */</span><br><span class="line">    public function wxLogin()</span><br><span class="line">    &#123;</span><br><span class="line">        //接收参数</span><br><span class="line">        $request                 = $this-&gt;request()-&gt;getParams();</span><br><span class="line">        $filter                  = [];</span><br><span class="line">        $filter[&apos;appid&apos;]         = $request[&apos;appid&apos;];</span><br><span class="line">        $filter[&apos;code&apos;]          = $request[&apos;code&apos;];</span><br><span class="line">        $filter[&apos;userInfo&apos;]      = $request[&apos;userInfo&apos;];</span><br><span class="line">        $filter[&apos;rawData&apos;]       = $request[&apos;rawData&apos;];</span><br><span class="line">        $filter[&apos;signature&apos;]     = $request[&apos;signature&apos;];</span><br><span class="line">        $filter[&apos;encryptedData&apos;] = $request[&apos;encryptedData&apos;];</span><br><span class="line">        $filter[&apos;iv&apos;]            = $request[&apos;iv&apos;];</span><br><span class="line">        //校验参数</span><br><span class="line">        $check = $this-&gt;checkAppLogin($filter);</span><br><span class="line">        //获取第三方接口调用凭证（令牌）</span><br><span class="line">        $comAccToken = $this-&gt;getComAccessToken();</span><br><span class="line">        //调用微信服务器接口，获，openId + sessionKey + （unionId）</span><br><span class="line">        $url       = &apos;https://api.weixin.qq.com/sns/component/jscode2session&apos;;</span><br><span class="line">        $loginInfo = CommonService::getInstance()-&gt;httpsCurl($url, &apos;get&apos;, &apos;json&apos;, [</span><br><span class="line">            &apos;appid&apos;                  =&gt; $filter[&apos;appid&apos;],</span><br><span class="line">            &apos;js_code&apos;                =&gt; $filter[&apos;code&apos;],</span><br><span class="line">            &apos;grant_type&apos;             =&gt; &apos;authorization_code&apos;,</span><br><span class="line">            &apos;component_appid&apos;        =&gt; WX_APP_ID,</span><br><span class="line">            &apos;component_access_token&apos; =&gt; $comAccToken</span><br><span class="line">        ]);</span><br><span class="line">        //sha1散列算法加密，验证signature</span><br><span class="line">        $signature = sha1($filter[&apos;rawData&apos;] . $loginInfo[&apos;session_key&apos;]);</span><br><span class="line">        //加密数据解密算法，解密获取用户敏感信息</span><br><span class="line">        include_once ROOT_PATH . &apos;wxBizDataCrypt.php&apos;;</span><br><span class="line">        $decrypt = new \WXBizDataCrypt($filter[&apos;appid&apos;], $loginInfo[&apos;session_key&apos;]);</span><br><span class="line">        $errCode = $decrypt-&gt;decryptData($filter[&apos;encryptedData&apos;], $filter[&apos;iv&apos;], $userInfo);</span><br><span class="line">        //保存用户粉丝到用户服务，并调用帐号服务获取token</span><br><span class="line">        return $this-&gt;saveMiniAppFans($userInfo, $filter[&apos;appid&apos;], $loginInfo[&apos;session_key&apos;]);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/05/%E8%BF%99%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%80%E7%AF%87%E8%B4%9F%E8%83%BD%E9%87%8F%E6%96%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/05/%E8%BF%99%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%80%E7%AF%87%E8%B4%9F%E8%83%BD%E9%87%8F%E6%96%87/" class="post-title-link" itemprop="url">这可能是一篇负能量文</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-05 15:24:04" itemprop="dateCreated datePublished" datetime="2019-11-05T15:24:04+08:00">2019-11-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 15:27:17" itemprop="dateModified" datetime="2019-11-18T15:27:17+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>650</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<p>11月到了，距离2020年只剩下两个月。看着18年许下的愿望清单，感慨万千。<strong>（轻音乐 - Drum.mp3）</strong><br><img src="https://upload-images.jianshu.io/upload_images/7429691-a30ccf757782a778.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>自毕业也来，我努力过，吐槽过，多次放弃过，但最后还是坚持下来了。工作上的不易我很少跟别人提起，什么样的苦只有自己知道。或许，这是90后的倔强吧，苦自己承担，累休息就好。现在的工作是稳定了，但变得安逸了，熟悉的业务，熟悉的流程，熟悉的人，工作很好开展，唯独没有找到自己喜欢做的事情。所以第一项我算是完成了一半，第二项从业绩考核上看，3.5良好算是达成成就吧。<br>  对于学习，刚开始我一刻都不敢松懈，不敢怠慢，时间是最好的灭火器，慢慢的湮灭我心中的那团火，坚持了半年后，我开始疲了，我开始找不到学习的方向，找不到学习的动力，开始变得“混”了，对于工作的热情、积极性渐渐淡去，对于生活的趣味性也渐渐没了期待没有念想，有的，就是那到手的几千块钱工资。第三项勉强完成，学习了swoole、swoole相关的框架、开发实践了千万级数据的处理、微服务架构体系相关的理论和组件认识；第五项看了2本书《php内核剖析》《php7底层设计与源代码实现》，完成度不到一半，甚是惭愧。<br>两次省外旅游是我一直期待的，是最没有时间去完成的。或许，还差一个旅途中的伴侣吧。最想去的地方就是内蒙古大草原和海南三亚了，一个向南一个往北，通往的都是自由广阔的天空。如果可以的话，忙完双十一后（公司是做电商的），我希望可以调休出去走走。<br>大学贷款学费这个事情，水到渠成，不愿多说，多讲。<br>最后，希望自己能坚持写文，坚持学习，坚持做一个上进的男孩。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/13/%E9%A1%B6%E4%B8%8D%E4%BD%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/13/%E9%A1%B6%E4%B8%8D%E4%BD%8F/" class="post-title-link" itemprop="url">生活还得继续，应届毕业生再有热情也顶不住啊！</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-13 15:28:32" itemprop="dateCreated datePublished" datetime="2019-08-13T15:28:32+08:00">2019-08-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 15:31:07" itemprop="dateModified" datetime="2019-11-18T15:31:07+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>747</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<p>曾经有一个医生讲过这样一句话：“当你明显感觉到你身体的某个器官时，你会发现它病了……”，是的，从毕业以后，我一直努力的投入到工作中，为了项目能够顺利进行，我与团队的小伙伴一起没日没夜的加班，每晚10点走已是常态，有时候呆到凌晨几点钟的都有，一天工作均12个小时，然当初进去的时候人事说的是早九晚六，周末双休，进去之后，却是另一种说辞。</p>
<p>我的领导常说：“纯粹的开发是不存在的，产品开发要以产品交付为核心，不以产品交付为核心的开发都是耍流氓”“现在项目进度很赶，加班将会是我们的常态，上班记得带好换洗衣服，实在不行就在隔壁酒店住得了”“我们现在开发测试同学的工作要日事日清，每天的工作不能留到明天，做不完就加班”。</p>
<p>作为一名普普通通的应届生，我们对于工作的要求其实并不高，因为我们刚从学校出来，大部分过的都属于那种一人吃饱全家享福的日子，没有房贷没有车贷，没有女朋友的则更省事，我们期望更多的是在于职业技能的提高和人际关系的改善，热情积极是我们的专有标签，年轻代表我们有着无限可能，但有时候往往你的领导就会利用这一点，我的领导曾跟我说过：“很高兴你从实习生转正，我们将培养你成为职业化的开发人员，你已被列入严格培养制度内，你需要怎样….你应该怎样…..我们看好你的成长”。起初我还蛮感激的，领导看好我，我应该努力努力做出成绩来，到后来我发现他的眼里只有项目进度，不管用什么办法，只想看到项目达标，他说，做不完就给我加班，加班解决不了的就周末也来，直到项目完成。加班不可怕，可怕的是没日没夜无时无刻，时间长达几个月，我的身体现在就很疲惫很累，曾经凌晨两点我在公司的时候真怕自己在那一刻猝死，感觉自己就是一架机器在不停的运转，心脏是核心，承载不住就挂了。</p>
<p>生命诚可贵，加班需谨慎，量力而行，不要把身体拼坏了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/10/Leetcode%E5%8A%9B%E6%89%A3%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE%E2%80%94%E2%80%94%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/10/Leetcode%E5%8A%9B%E6%89%A3%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE%E2%80%94%E2%80%94%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/" class="post-title-link" itemprop="url">Leetcode力扣算法题目——三数之和</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-10 15:31:43" itemprop="dateCreated datePublished" datetime="2019-08-10T15:31:43+08:00">2019-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 15:35:20" itemprop="dateModified" datetime="2019-11-18T15:35:20+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>828</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<p>给定一个包含 n 个整数的数组 nums，判断 nums 中是否存在三个元素 a，b，c ，使得 a + b + c = 0 ？找出所有满足条件且不重复的三元组。</p>
<p><strong>注意：答案中不可以包含重复的三元组。</strong></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">例如, 给定数组 nums = [-1, 0, 1, 2, -1, -4]，</span><br><span class="line"></span><br><span class="line">满足要求的三元组集合为：</span><br><span class="line">[</span><br><span class="line">  [-1, 0, 1],</span><br><span class="line">  [-1, -1, 2]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="PHP代码实现"><a href="#PHP代码实现" class="headerlink" title="PHP代码实现"></a>PHP代码实现</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer[] $nums</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Integer[][]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">threeSum</span><span class="params">($nums)</span> </span>&#123;</span><br><span class="line">        sort($nums);</span><br><span class="line">        $len = count($nums);</span><br><span class="line">        $res = [];</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len <span class="number">-2</span>; $i ++) &#123;</span><br><span class="line">            $l = $i + <span class="number">1</span>;</span><br><span class="line">            $r = $len - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> ($l &lt; $r) &#123;</span><br><span class="line">                $sum = $nums[$i] + $nums[$l] + $nums[$r];</span><br><span class="line">                <span class="keyword">if</span> ($sum === <span class="number">0</span> &amp;&amp; $r &gt; $l) &#123;</span><br><span class="line">                    $tmp   = [$nums[$i], $nums[$l], $nums[$r]];</span><br><span class="line">                    $res[] = $tmp;</span><br><span class="line">                    <span class="keyword">while</span> ($l &lt; $r &amp;&amp; $nums[$r] === $nums[$r - <span class="number">1</span>]) &#123;</span><br><span class="line">                        $r--;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">while</span> ($l &lt; $r &amp;&amp; $nums[$l] === $nums[$l + <span class="number">1</span>]) &#123;</span><br><span class="line">                        $l++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    $r--;</span><br><span class="line">                    $l++;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> ($sum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                        $r--;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        $l++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array_unique($res, SORT_REGULAR);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p><img src="https://upload-images.jianshu.io/upload_images/7429691-8e2f9e6d9c423f10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/10/Leetcode%E5%8A%9B%E6%89%A3%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE%E2%80%94%E2%80%94%E7%BB%84%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/shahao.jpg">
      <meta itemprop="name" content="沙蒿">
      <meta itemprop="description" content="大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="指尖记忆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/10/Leetcode%E5%8A%9B%E6%89%A3%E7%AE%97%E6%B3%95%E9%A2%98%E7%9B%AE%E2%80%94%E2%80%94%E7%BB%84%E5%90%88/" class="post-title-link" itemprop="url">Leetcode力扣算法题目——组合</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-10 15:29:42" itemprop="dateCreated datePublished" datetime="2019-08-10T15:29:42+08:00">2019-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-18 15:30:57" itemprop="dateModified" datetime="2019-11-18T15:30:57+08:00">2019-11-18</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>746</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <meta name="referrer" content="no-referrer" />


<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>给定两个整数 n 和 k，返回 1 … n 中所有可能的 k 个数的组合。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">示例:</span><br><span class="line">输入: n = 4, k = 2</span><br><span class="line">输出:</span><br><span class="line">[</span><br><span class="line">  [2,4],</span><br><span class="line">  [3,4],</span><br><span class="line">  [2,3],</span><br><span class="line">  [1,2],</span><br><span class="line">  [1,3],</span><br><span class="line">  [1,4],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="PHP代码实现"><a href="#PHP代码实现" class="headerlink" title="PHP代码实现"></a>PHP代码实现</h3><p>array_slice 从数组中取出一段</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $n</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $k</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Integer[][]</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">combine</span><span class="params">($n, $k)</span> </span>&#123;</span><br><span class="line">        $arr = range(<span class="number">1</span>,$n);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::combination($arr, $k);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">combination</span><span class="params">($st_array, $m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $re_array = <span class="keyword">array</span>();</span><br><span class="line">        $n = count($st_array);</span><br><span class="line">        <span class="keyword">if</span> ($m &lt;= <span class="number">0</span> || $m &gt; $n) &#123;</span><br><span class="line">            <span class="keyword">return</span> $re_array;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $t = <span class="keyword">array</span>($st_array[$i]);</span><br><span class="line">            <span class="keyword">if</span> ($m == <span class="number">1</span>) &#123;</span><br><span class="line">                $re_array[] = $t;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $item_array = array_slice($st_array, $i + <span class="number">1</span>);</span><br><span class="line">                $c          = <span class="keyword">self</span>::combination($item_array, $m - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">foreach</span> ($c <span class="keyword">as</span> $v) &#123;</span><br><span class="line">                    $re_array[] = array_merge($t, $v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $re_array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p><img src="https://upload-images.jianshu.io/upload_images/7429691-9aa9ccce8053edd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="沙蒿"
      src="/images/shahao.jpg">
  <p class="site-author-name" itemprop="name">沙蒿</p>
  <div class="site-description" itemprop="description">大家好，我是一个很不喜欢写文的程序员，在这里我可以随便的写，因为根本没有人会看到。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">沙蒿</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">40k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">36 分钟</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

</body>
</html>
